import{r as c,j as e}from"./app-bX8639qO.js";import{f as m,c as k}from"./imageUtils-CYfP8GDk.js";const z=({label:b,onChange:p,error:h})=>{const[a,n]=c.useState([]),d=c.useRef(null),u=c.useRef([]);c.useEffect(()=>{const s=a.filter(t=>t.status==="done"&&t.processedFile).map(t=>t.processedFile);(s.length!==u.current.length||s.some((t,r)=>t!==u.current[r]))&&(u.current=s,p(s))},[a,p]);const f=s=>{const l=s.target.files?Array.from(s.target.files):[];if(l.length===0)return;const t=l.map(r=>({id:Math.random().toString(36).substr(2,9),originalFile:r,processedFile:null,progress:0,processedSize:0,previewUrl:URL.createObjectURL(r),status:"pending"}));n(r=>[...r,...t]),d.current&&(d.current.value="")},g=async s=>{const l=a.find(t=>t.id===s);if(!(!l||l.status!=="pending")){n(t=>t.map(r=>r.id===s?{...r,status:"processing"}:r));try{const t=l.originalFile.size;let r=0;const o=setInterval(()=>{r+=t*.15,r>=t&&(r=t,clearInterval(o)),n(x=>x.map(i=>i.id===s?{...i,processedSize:r,progress:Math.round(r/t*100)}:i))},100),v=await k(l.originalFile);clearInterval(o);const N=URL.createObjectURL(v);n(x=>x.map(i=>i.id===s?{...i,status:"done",processedFile:v,progress:100,processedSize:t,previewUrl:N}:i))}catch(t){console.error("Image processing failed:",t),n(r=>r.map(o=>o.id===s?{...o,status:"error"}:o))}}},j=s=>{n(l=>l.filter(t=>t.id!==s))},w=()=>{a.filter(s=>s.status==="pending").forEach(s=>g(s.id))};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700",children:b}),e.jsx("p",{className:"text-xs text-slate-500",children:"Unggah satu atau beberapa foto sekaligus"})]}),a.some(s=>s.status==="pending")&&e.jsx("button",{type:"button",onClick:w,className:"text-xs bg-emerald-500 text-white font-bold px-3 py-1.5 rounded-lg hover:bg-emerald-600 shadow-sm transition-all",children:"Proses Semua"})]}),e.jsxs("div",{className:"border-2 border-dashed border-slate-200 rounded-2xl p-8 bg-slate-50 hover:bg-slate-100/50 hover:border-blue-300 transition-all cursor-pointer group",onClick:()=>d.current?.click(),children:[e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-3",children:[e.jsx("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-100 group-hover:scale-110 transition-transform",children:e.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})})}),e.jsx("p",{className:"text-sm text-slate-600 font-bold",children:"Klik untuk menambah foto"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Gunakan format JPG, PNG, atau WebP"})]}),e.jsx("input",{ref:d,type:"file",multiple:!0,className:"hidden",onChange:f,accept:"image/*"})]}),a.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4",children:a.map(s=>e.jsx("div",{className:"relative bg-white rounded-2xl border border-slate-100 shadow-sm overflow-hidden group",children:e.jsxs("div",{className:"flex p-3 gap-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-xl overflow-hidden flex-shrink-0 bg-slate-100 border border-slate-100",children:s.previewUrl?e.jsx("img",{src:s.previewUrl,className:"w-full h-full object-cover",alt:"preview"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),e.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[e.jsx("p",{className:"text-sm font-bold text-slate-900 truncate pr-6",children:s.originalFile.name}),e.jsx("p",{className:"text-xs text-slate-500 font-medium",children:m(s.originalFile.size)}),s.status==="processing"&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full bg-slate-100 rounded-full h-1.5 overflow-hidden",children:e.jsx("div",{className:"bg-blue-600 h-1.5 rounded-full transition-all duration-300",style:{width:`${s.progress}%`}})}),e.jsxs("p",{className:"text-[10px] text-blue-600 font-mono mt-1",children:[m(s.processedSize)," / ",m(s.originalFile.size)]})]}),s.status==="done"&&e.jsxs("div",{className:"mt-1 flex items-center text-emerald-600",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Teroptimasi"})]}),s.status==="pending"&&e.jsx("button",{type:"button",onClick:l=>{l.stopPropagation(),g(s.id)},className:"mt-2 text-[10px] text-blue-600 font-bold hover:underline uppercase tracking-wider",children:"Klik untuk optimasi"})]}),e.jsx("button",{type:"button",onClick:l=>{l.stopPropagation(),j(s.id)},className:"absolute top-2 right-2 p-1 text-slate-400 hover:text-red-500 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})},s.id))}),h&&e.jsxs("div",{className:"flex items-center space-x-2 text-red-500 text-xs mt-2 font-medium bg-red-50 p-2 rounded-lg border border-red-100",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),e.jsx("span",{children:h})]})]})};export{z as M};
